{
  "hash": "507475b64062a9232b9393ec11974360",
  "result": {
    "markdown": "---\ntitle: \"Transformación de datos con tidyr\"\nsubtitle: |\n  Ejemplos de como transformar datos usando R\ndate: \"2022-11-13\"\nimage: img1_tidy.png\ncategories: [tidyverse, tidyr, pivote ]\ncode-fold: show\nbibliography: adoe.bib\n\n---\n\n```{=html}\n<style>\np{\n  text-indent: 1em;\n}\n</style>\n```\n\n\n## Introducción\n\n\nPara realizar un análisis de un determinado conjunto de datos en su mayoría los encontraremos desordenados por lo que necesita una transformación, este debe cumplir así una estructura determinada respondiendo a nuestras necesidades.\n\n\n## _Tidy data_\n\n\n> Es una manera de organizar los datos tabulares en una estructura consistente.\n\nTal conjunto de datos cumple con tres reglas relacionadas entre sí como se muestra a continuación:\n\n\n![Imagen 1. a) Cada variable está en su propia columna. b) Cada observación o caso, se encuentra en su propio renglón (fila) y c) Cada valor dentro de una celda; cada celda es un valor único.](img1_tidy.png){fig-align=\"center\" width=\"380\"}\n\n\n## Ejemplos\n\n\nA continuación, trabajaremos con tres conjuntos de datos:\n\nTabla 3.1 de @hr2008analisis.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Método de ensamble</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> A </th>\n   <th style=\"text-align:right;\"> B </th>\n   <th style=\"text-align:right;\"> C </th>\n   <th style=\"text-align:right;\"> D </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n</br>\n\nSimilar al ejemplo anterior con una ligera diferencia. Tabla 3.2 de @hr2008analisis.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Comparacion de cuatro tipos (cuatro tratamientos)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Tipo de cuero </th>\n   <th style=\"text-align:right;\"> Obs 1 </th>\n   <th style=\"text-align:right;\"> Obs 2 </th>\n   <th style=\"text-align:right;\"> Obs 3 </th>\n   <th style=\"text-align:right;\"> Obs 4 </th>\n   <th style=\"text-align:right;\"> Obs 5 </th>\n   <th style=\"text-align:right;\"> Obs 6 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 264 </td>\n   <td style=\"text-align:right;\"> 260 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 241 </td>\n   <td style=\"text-align:right;\"> 262 </td>\n   <td style=\"text-align:right;\"> 255 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 208 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:right;\"> 216 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:right;\"> 213 </td>\n   <td style=\"text-align:right;\"> 206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:right;\"> 263 </td>\n   <td style=\"text-align:right;\"> 219 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 230 </td>\n   <td style=\"text-align:right;\"> 228 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 217 </td>\n   <td style=\"text-align:right;\"> 226 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n   <td style=\"text-align:right;\"> 227 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:right;\"> 222 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n</br>\n\nTabla en formato largo.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Dosis de fertilizante</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Ensayo </th>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> Dosis </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Nitrógeno </td>\n   <td style=\"text-align:right;\"> 88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Fósforo </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Potasio </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Nitrógeno </td>\n   <td style=\"text-align:right;\"> 91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Fósforo </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Potasio </td>\n   <td style=\"text-align:right;\"> 28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Nitrógeno </td>\n   <td style=\"text-align:right;\"> 99 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Fósforo </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Potasio </td>\n   <td style=\"text-align:right;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Nitrógeno </td>\n   <td style=\"text-align:right;\"> 94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Fósforo </td>\n   <td style=\"text-align:right;\"> 28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Potasio </td>\n   <td style=\"text-align:right;\"> 31 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n</br>\n\n## Pivotado\n\nPara realizar el pivotado usaremos dos funciones dentro de la librería `tidyr`:\n\n-   `pivot_longer()`\n\n\n-   `pivot_wider()`\n\n\n\n## Funciones pivote en acción\n\n\n### Tabla 1\n\nUn conjunto de datos amplio que transformaremos a un formato largo.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_ensamble_l <- m_ensamble_t %>% \n  tidyr::pivot_longer(cols = 1:4,\n                      names_to = 'Método',\n                      values_to = 'Minutos')\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Método de ensamble</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Método </th>\n   <th style=\"text-align:right;\"> Minutos </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Tabla 2\n\nNota que esta tabla contiene observaciones como variables, un poco diferente al ejemplo anterior, pero no hay inconveniente a la hora de transformar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntc <- tipos_c %>% \n  tidyr::pivot_longer(cols = 2:7,\n                      names_to = \"Observación\",\n                      values_to = \"Lectura\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Comparacion de cuatro tipos (cuatro tratamientos)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Tipo de cuero </th>\n   <th style=\"text-align:left;\"> Observación </th>\n   <th style=\"text-align:right;\"> Lectura </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 1 </td>\n   <td style=\"text-align:right;\"> 264 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 2 </td>\n   <td style=\"text-align:right;\"> 260 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 3 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 4 </td>\n   <td style=\"text-align:right;\"> 241 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 5 </td>\n   <td style=\"text-align:right;\"> 262 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Obs 6 </td>\n   <td style=\"text-align:right;\"> 255 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 1 </td>\n   <td style=\"text-align:right;\"> 208 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 2 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 3 </td>\n   <td style=\"text-align:right;\"> 216 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 4 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 5 </td>\n   <td style=\"text-align:right;\"> 213 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Obs 6 </td>\n   <td style=\"text-align:right;\"> 206 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 1 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 2 </td>\n   <td style=\"text-align:right;\"> 263 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 3 </td>\n   <td style=\"text-align:right;\"> 219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 4 </td>\n   <td style=\"text-align:right;\"> 225 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 5 </td>\n   <td style=\"text-align:right;\"> 230 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Obs 6 </td>\n   <td style=\"text-align:right;\"> 228 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 1 </td>\n   <td style=\"text-align:right;\"> 217 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 2 </td>\n   <td style=\"text-align:right;\"> 226 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 3 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 4 </td>\n   <td style=\"text-align:right;\"> 227 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 5 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> Obs 6 </td>\n   <td style=\"text-align:right;\"> 222 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Tabla 3\n\nPor último, nos encontramos con redundancia en los datos como ocurre en la columna _variable_ la cual deseo convertir en variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfert_t <- tidyr::pivot_wider(fert, names_from = \"Variable\",\n            values_from = \"Dosis\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style=\"font-family: Lato; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Dosis de fertilizante</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Ensayo </th>\n   <th style=\"text-align:right;\"> Nitrógeno </th>\n   <th style=\"text-align:right;\"> Fósforo </th>\n   <th style=\"text-align:right;\"> Potasio </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 88 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 91 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 99 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 94 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n#### Explicación\n\n- `pivot_longer()`\n* `cols` selecciona el número de variables presentes en columnas y que pasarán a una sola.\n* `names_to` es el nombre de la nueva columna que contiene las variables.\n* `values_to` el nombre a elegir que mostrará los valores presentes del conjunto de datos.\n\n- `pivot_wider()`\n* `names_from` hace referencia a la columna _Variable_ pasando a ser una columna.\n* `values_from` los valores de dosis de fertilizante para cada variable (columna).\n\n\n## Conclusiones\n\nLas funciones presentadas aquí nos facilitan transformar nuestros datos una vez que distinguimos de manera clara entre variables, observaciones y valores.\nTal ordenamiento puede ser interpretado sin problema por la computadora, ahora están listos para un documento o un análisis estadístico.\n\n\n\n\n## Referencias\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}